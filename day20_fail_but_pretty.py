import math
from itertools import product
from dataclasses import dataclass
from typing import Tuple, List
import z3


@dataclass
class Tile:
    number: int
    top: str
    bottom: str
    left: str
    right: str


def generate_possible_joins(tile: Tile, side: int) -> List[Tuple[int, bool, bool, int]]:
    out = []
    for rot, h_f, v_f in product(range(4), [False, True], [False, True]):
        top, bottom, left, right = tile.top, tile.bottom, tile.left, tile.right

        if h_f:
            bottom = bottom[::-1]
            top = top[::-1]
            left, right = right, left

        if v_f:
            left = left[::-1]
            right = right[::-1]
            top, bottom = bottom, top

        for _ in range(rot):
            top, right, bottom, left = left[::-1], top, right[::-1], bottom

        side_to_use = [top, right, bottom, left][side]
        val = int(side_to_use.replace("#", "1").replace(".", "0"), 2)
        out.append((rot, h_f, v_f, val))
    return out


def part1(tiles: List[Tile]):
    width = int(math.sqrt(len(tiles)))

    s = z3.Solver()

    rotations = [z3.Int(f"rot_{t.number}") for t in tiles]
    for r in rotations:
        s.add(r >= 0, r < 4)

    h_flips = [z3.Bool(f"flip_h_{t.number}") for t in tiles]
    v_flips = [z3.Bool(f"flip_v_{t.number}") for t in tiles]

    positions = [z3.Int(f"pos_{t.number}") for t in tiles]

    s.add(z3.Distinct(positions))

    for p in positions:
        s.add(p >= 0, p < len(tiles))

    hor_joins = [
        [z3.Int(f"hor_join_{x}_{y}") for x in range(width - 1)] for y in range(width)
    ]

    ver_joins = [
        [z3.Int(f"ver_join_{x}_{y}") for x in range(width)] for y in range(width - 1)
    ]


    # do right-sides
    for x, y in product(range(width - 1), range(width)):
        idx = y * width + x
        this_join = hor_joins[y][x]
        this_rot = rotations[idx]
        this_h_f = h_flips[idx]
        this_v_f = v_flips[idx]
        this_pos = positions[idx]

        for i, t in enumerate(tiles):
            possible_joins = generate_possible_joins(t, 1)

            for rot, h_f, v_f, val in possible_joins:
                s.add(
                    z3.If(
                        z3.And(this_pos == i, this_rot == rot, this_h_f == h_f, this_v_f == v_f),
                        this_join == val,
                        True
                    )
                )

    # bottom sides
    for x, y in product(range(width), range(width - 1)):
        idx = y * width + x
        this_join = ver_joins[y][x]
        this_rot = rotations[idx]
        this_h_f = h_flips[idx]
        this_v_f = v_flips[idx]
        this_pos = positions[idx]

        for i, t in enumerate(tiles):
            possible_joins = generate_possible_joins(t, 2)

            for rot, h_f, v_f, val in possible_joins:
                s.add(
                    z3.If(
                        z3.And(this_pos == i, this_rot == rot, this_h_f == h_f, this_v_f == v_f),
                        this_join == val,
                        True
                    )
                )


    # do left-sides
    for x, y in product(range(1, width), range(width)):
        idx = y * width + x
        this_join = hor_joins[y][x - 1]
        this_rot = rotations[idx]
        this_h_f = h_flips[idx]
        this_v_f = v_flips[idx]
        this_pos = positions[idx]

        for i, t in enumerate(tiles):
            possible_joins = generate_possible_joins(t, 3)

            for rot, h_f, v_f, val in possible_joins:
                s.add(
                    z3.If(
                        z3.And(this_pos == i, this_rot == rot, this_h_f == h_f, this_v_f == v_f),
                        this_join == val,
                        True
                    )
                )

    # bottom sides
    for x, y in product(range(width), range(1, width)):
        idx = y * width + x
        this_join = ver_joins[y - 1][x]
        this_rot = rotations[idx]
        this_h_f = h_flips[idx]
        this_v_f = v_flips[idx]
        this_pos = positions[idx]

        for i, t in enumerate(tiles):
            possible_joins = generate_possible_joins(t, 0)

            for rot, h_f, v_f, val in possible_joins:
                s.add(
                    z3.If(
                        z3.And(this_pos == i, this_rot == rot, this_h_f == h_f, this_v_f == v_f),
                        this_join == val,
                        True
                    )
                )

    assert s.check() == z3.sat, "fuck"

    m = s.model()

    assignments = {(x, y): m[positions[y * width + x]].as_long() for x, y in product(range(width), repeat=2)}

    corners = [
        tiles[assignments[(0, 0)]],
        tiles[assignments[(width - 1, 0)]],
        tiles[assignments[(0, width - 1)]],
        tiles[assignments[(width - 1, width - 1)]],
    ]

    return math.prod(t.number for t in corners)


def parse_tile(tile: str) -> Tile:
    num, *data = tile.splitlines()
    num = int(num[len("Tile ") :].strip(":"))

    top = data[0]

    bottom = data[-1]

    left = "".join(l[0] for l in data)

    right = "".join(l[-1] for l in data)

    return Tile(num, top, bottom, left, right)


inp_o = """
Tile 3571:
##..##....
..##..#..#
#...##....
.....#...#
..........
...###....
#......##.
#...#...#.
#...##...#
#.####.##.

Tile 2687:
#..##..###
..........
.....##..#
.#.#..##.#
#.#..#..##
#.....#...
#...#.....
##....##..
#...#...##
..#.#.#.##

Tile 3049:
##.#.#.###
....##.###
....##....
#.........
#.#...#..#
#..##....#
#.#......#
#..#..##..
#......###
#.#..#...#

Tile 1597:
###..##...
##.....###
.#..#..#.#
#.......#.
#.#.......
.#..#.....
#.....#...
#........#
##.#...##.
.....#.###

Tile 1301:
#.##.#.###
#........#
....#.....
#.....####
.#....#.##
.....#....
#..##..#.#
.....#..##
.#.##..#.#
#...######

Tile 3259:
..#####.#.
.....#...#
#...#.....
...##...#.
.#..#..##.
.#.......#
........##
#.......#.
.#.#...#..
#...#.#..#

Tile 3989:
#..#..####
..........
#........#
.#....#...
..........
#.........
.#........
#........#
...##.####
.######.##

Tile 3803:
#.####...#
.###.#..#.
....##..#.
#........#
..##..#...
####.#....
..#...#...
#..#.....#
..##....#.
#....#...#

Tile 2897:
.#..##.#.#
..#.#...##
#........#
###.#..#.#
...#..#.##
...#....##
....##...#
.....##..#
.#....#...
..##....##

Tile 2843:
##.###..##
#.#.......
#....#....
#..##.##..
.##..#.##.
#....#....
#.#...#.##
..........
.#...#...#
###..#..##

Tile 3023:
.#..###.#.
.........#
..........
.#........
#.#....#.#
....#...#.
#.......#.
##.#.....#
..#...#..#
.....####.

Tile 2887:
#....##...
#...#.....
##...##...
#.....##.#
.......#..
#......#.#
..##..#..#
....#....#
#.###.....
#.####..#.

Tile 1013:
#..####.#.
#.##...#.#
#..#..#...
#..#..#..#
...#......
#.####...#
.#..##..##
...#.#..##
....##..##
#.##.#.#.#

Tile 3733:
###.##.#.#
..#....#..
#...#.#..#
....###..#
.#........
.....#....
........##
##........
#........#
#.#...#..#

Tile 3691:
.##...####
##..##....
#.#.##..##
#........#
#.....##.#
.....#....
##.#.....#
#..#.....#
..#.......
####....#.

Tile 3061:
##.....#..
.....#...#
....##...#
###.#.....
#..#..###.
#.#.###..#
..#......#
#..#.#...#
..#.......
..#.#..#..

Tile 1489:
###.......
.....##...
..#...##..
#.....#...
#.#......#
##.#..####
...##.#...
...#...#.#
..........
.##.##.#.#

Tile 1637:
#########.
.#.....#..
#........#
#........#
.##.....##
.........#
#....#..##
#.....####
...###...#
.#..##..##

Tile 1069:
#.#...####
##...#...#
.....#...#
.......##.
......#..#
#........#
#...#.....
......#...
#.#..#....
####.##.#.

Tile 1039:
#..#######
###.......
.....#....
#.........
....#....#
...####...
.#...##...
#.#....#.#
........##
#.#..#..#.

Tile 2767:
.#.#..#.##
.#..#....#
#..#.#....
#.#..##..#
.####.#.##
#....##...
....##..##
###.....#.
..........
....#.###.

Tile 2957:
####.#####
.......##.
...#.....#
...##..##.
...##.##..
#..#..#..#
.....#....
#..#....#.
.##.......
.##..#.##.

Tile 2789:
.##..#.#.#
#.#.....##
#....#...#
#....##...
..#..#....
#.........
#.#..#..##
#........#
.#.......#
#####...##

Tile 2837:
.....#...#
.....#.#.#
#.......#.
#...#...#.
..#.....#.
..#.#..#..
##.......#
....#....#
#...#.....
##.###....

Tile 3251:
.######...
...#......
.#.#..###.
#..#.##..#
###.#....#
#.#......#
..#..###..
##.#..#..#
...#...###
##.#..##..

Tile 3137:
#####.#..#
#.#..#.##.
#.#..#....
#.........
.........#
.........#
...#......
#...#...#.
....#..#.#
.#.###.#.#

Tile 3433:
.##..####.
...#......
#..##....#
....#....#
#..###....
..#......#
.#..###...
.##.#.....
.........#
.....#....

Tile 2551:
#.########
#.#.......
##..#...##
#.#..###.#
#........#
.#.#....#.
#........#
.##....#..
#........#
##..##.#..

Tile 2647:
..####..##
##....#..#
#.........
###.#.....
#......#..
....#...##
.#..##.#.#
.#.#..#...
.....##.##
.#.#...#..

Tile 1087:
#..###..##
#...#.#.#.
.......#..
..#.#.#..#
#.......#.
#....#....
....#....#
##...##..#
#..#......
.#..#.###.

Tile 1423:
..#....#.#
#........#
.#.##.##..
#.###.#.#.
#.#......#
...##...##
#....#....
....#....#
.........#
#####....#

Tile 1759:
..#.#..#..
##...#...#
....#..#..
#....#....
.##..##..#
...#.#...#
#..#.....#
##.......#
......#..#
#.##......

Tile 1583:
.###.####.
......###.
......#..#
.#...##...
#...#....#
..#.##....
#...##..#.
......#...
#.....###.
####.#....

Tile 1171:
###......#
#...##...#
#####..##.
#.......#.
#.#...#..#
#....#....
....#....#
##.....#.#
#.#..#..##
#.#.#..##.

Tile 2801:
.###.####.
......#...
##..##.#.#
.....#....
#......#..
###..##..#
##.#..##.#
#..#..#...
#..#.#...#
#..###.###

Tile 1559:
.##..#...#
#.##..#...
...##..#..
..#.#.....
...#...#..
.........#
...#.....#
#..##.#..#
##..##....
...###...#

Tile 2609:
##.#..####
..........
#........#
##.###...#
#.#..#....
..#..##..#
#....#.#.#
#.#.......
#....#...#
#.####.#.#

Tile 2287:
#......#.#
.....#.#.#
..#..#...#
##.#..#...
..#..#.###
.......###
#......##.
#.##.##...
......#..#
#####.##.#

Tile 3659:
.###.#####
#.#.......
..........
..#.....##
#..#......
#.#.#...##
#.........
.#...#....
##.....#..
#####.##.#

Tile 3539:
.......#.#
..##...#..
.....#.#.#
##.#......
####......
...#..#...
#.......##
#...#.....
#..#.....#
.##.#....#

Tile 3121:
..##.#...#
.###..#...
##.#.#....
#.....#..#
#.#.......
#.........
....#...##
......###.
#........#
#..###..##

Tile 2237:
...##.....
..........
...#......
#....#...#
#.........
.......#..
#...###..#
.....#...#
.........#
#.####.##.

Tile 1277:
.###...##.
.......###
#.....##..
#.##..###.
#.#..#....
.....#....
#...#....#
#.#......#
#...###..#
...##...##

Tile 2161:
..#####..#
#....##..#
#.....#..#
....#....#
.....#.##.
..........
#......#.#
#..#......
#....#..##
.##.....#.

Tile 3709:
.#..#...##
#..#.....#
...#....#.
..........
.#...#....
..........
....##....
#.........
.........#
..####....

Tile 1117:
##.##.#..#
.....##...
.#.#..#.##
.#...#..#.
#.##.#....
####.....#
##..#.....
#.........
#...##...#
####..#.#.

Tile 2081:
##.##.###.
#...#.....
#.....#...
#.#..#.#..
#.....#..#
...#.....#
#....#....
......#..#
.#.##..#..
###..#.#.#

Tile 1709:
##...#.##.
###..#....
#.......#.
#.....##..
.........#
#....#..##
..#...##..
#...#.....
#...#.#..#
.###.#....

Tile 2927:
...###..##
##.#......
..........
##........
#....#...#
.......##.
#.....#..#
##.#.#....
#......#..
...#.####.

Tile 1499:
#....##.#.
......#...
#........#
......#...
.#.......#
#.#...#.##
..#....#.#
#...#.....
.........#
#.....##.#

Tile 1453:
#.##.####.
..#...##..
.........#
.........#
#..#..#...
.........#
#....#.#..
#.....#..#
.#........
#....#....

Tile 1283:
.#.##..###
..#...#.#.
...##..#..
#.......#.
#......#..
#..##.....
#.......##
....##...#
..#.....##
##.#.#...#

Tile 2063:
......#.##
.........#
....##..#.
.#....##..
##........
.###.###.#
#.#....#..
....#...#.
#......###
#....####.

Tile 3529:
...###.##.
#....#...#
...#.....#
...#.#..#.
.#.#.....#
#...#.....
##..#..#..
#.....#..#
.#........
.#..#####.

Tile 2657:
..#.##..#.
##..#...##
#.....#...
#....##...
.....#..##
#.#..##.##
#.........
#.#...##.#
##....#...
##..####.#

Tile 2089:
.#########
##.#.##..#
#........#
#..###..##
...#......
##..#....#
#...#..#..
#..#....#.
..#.#....#
...###...#

Tile 3779:
#.#...##.#
.##...##..
.....##...
.#....##.#
###..##..#
#.#..#.#..
....##...#
##...#....
.#...#....
#######...

Tile 3217:
...##.....
....##....
.....##..#
##...#.#.#
###.......
...#...#..
...#.....#
#..#.#.###
##.#...#.#
.#.#..##..

Tile 3907:
..#..##.##
#.#.....##
#.......#.
.#...###..
..###.####
##.#..##..
#.........
##...#..#.
#....#....
.#.....#.#

Tile 3547:
#..#.##...
#..###...#
##.......#
.....#....
#...#...#.
#..#..#...
........#.
......##.#
.......#..
.##.#..##.

Tile 3187:
##.#.##...
#...#.##.#
#...#.....
#....#..##
....#.#..#
.....#....
.....#..##
....##...#
..........
#######.##

Tile 1217:
##.#####..
#.......#.
...#....##
#........#
#.#......#
.....#...#
#.........
....#...##
#...#.....
.#...###.#

Tile 3821:
#.###.###.
#.#......#
#..#.#...#
.##...#.##
...#....##
#...#..##.
#......#.#
###..#...#
.........#
#....##.##

Tile 1607:
##..#..##.
#.##....##
###.##.##.
.#....##.#
#.#..#...#
.....#.#..
#.#..#..#.
#.#..#....
..........
......##.#

Tile 1459:
.###.##..#
#.......#.
##........
..#...####
###.......
#....#....
.#.....#.#
###..#..##
.....#....
..#..#..##

Tile 2129:
....#.#..#
#.....##.#
#........#
..........
..#......#
#.....#..#
.#..##...#
#.#.#..#.#
#.........
#.##....##

Tile 1601:
.#.#.#.#.#
..#..##...
#.#.#...#.
....##....
....##.#..
..#.......
#.....#..#
#..##.#...
.........#
...####.#.

Tile 1801:
#.#...#.#.
..#....#..
#..#...#..
......#...
.....#....
#.#..##.##
#.........
...#.#...#
.#....#..#
#.....##..

Tile 2447:
..#.....##
.#..#...##
.....#.#..
.#....#..#
#...####.#
##.##..###
.#.......#
#.##.....#
#.......##
.###.#...#

Tile 2203:
#.....##..
#.#.......
........##
###...#...
..........
#..#.....#
....#.##.#
..##.....#
.#...#...#
#.###..#..

Tile 1381:
.#...#...#
....#.....
##.......#
#.....#...
.........#
.#.......#
.......##.
#.#.....##
.#..#.##..
##.#.##.#.

Tile 3163:
#...####.#
#......##.
...###.#.#
#....##...
#......###
.....#..##
.#..###...
#..##..#..
#.....#...
#.#####.##

Tile 3673:
.#....##.#
..#..####.
#.....#...
...#....#.
#....#...#
#....##.#.
##...#.#..
.#..#.#...
#..#.....#
####.##...

Tile 3919:
....##.##.
##..##....
...##...##
#...#.....
..........
....#..###
.#.....#..
....#..#.#
.##..#....
.#...###.#

Tile 2437:
..##...#.#
#....#...#
#..#.....#
..#.#...##
.......#..
........##
........##
.......#.#
#....#.#.#
##..#.###.

Tile 2969:
##.#.##.#.
#.##....#.
.##......#
#.#.#....#
#.#.......
.........#
....#.#.##
.#.......#
...#..#.##
##.#.##..#

Tile 2621:
.##.##.#..
.##...#...
..........
#.........
#.#.#.#..#
..#..#...#
.......#.#
#.#.....##
...#..#...
#.......##

Tile 3613:
##..#....#
#..##.....
..#.......
..#...#...
...#...#..
...#.....#
..#.....#.
..#.###..#
..........
..#.####..

Tile 2777:
##.#####.#
#.##.#...#
..#.......
.##...##.#
.........#
.#.###.##.
#......##.
#......##.
#...##..##
#..#....##

Tile 2711:
#..#..##..
..........
#.#......#
#.....####
..........
##.......#
........#.
#.......#.
#.#..#...#
#.#.####.#

Tile 2281:
.#.###...#
###....#..
..........
#.#..#..##
.........#
###..#.##.
####..#..#
##..#.....
##..#..#..
#.....#..#

Tile 1579:
....#..#..
#........#
#...#..#..
..##.#.#..
.###.#...#
....##..#.
...##.#...
.#.##....#
.#.......#
##...#...#

Tile 2411:
#.#....##.
..#...#..#
.#..##....
.#..##...#
.....#.#.#
......##..
#.#....###
.#.##....#
..#..#....
..#.###..#

Tile 2963:
.......##.
.....#....
.........#
#.....#..#
.....#.#..
.....#.##.
.#.#...###
#.#.......
.#.......#
###..#..#.

Tile 1693:
#.##..##..
..........
.........#
.##..#...#
.........#
#........#
###......#
..#...#...
.#.##....#
...#.#...#

Tile 2399:
###.#.##..
#...#.....
...#...#.#
###.......
.##.##....
##.....#.#
####......
##.......#
#..#...#.#
#...#.....

Tile 1913:
##.....###
........##
#.....###.
..........
....#...#.
#.#.....#.
#....#...#
..#...#...
....#..#..
#..####...

Tile 3343:
.....#.##.
..#...#...
####.....#
....#.....
......#..#
......#...
#........#
#.......#.
..#...#.#.
.....###.#

Tile 2557:
#.......##
....#...##
#......#.#
#.#.#.#.##
#..##.....
..###.#.#.
#..#......
#...#.....
....#....#
#.##...#.#

Tile 1097:
.#.#.#..##
..#.#.....
##........
.##...##..
..#..#...#
#........#
........##
#.#.#.....
.#.#.....#
#.##..#...

Tile 2591:
##..#..###
......#...
...###.#..
#.......#.
#.#.....#.
#.##..#...
....##.#..
#.#..#...#
#.###..#.#
##........

Tile 3413:
...##...##
..#....#..
##.#....#.
#..#....#.
#........#
#..#......
#.....#.##
##.....#.#
#....#....
####.#...#

Tile 2087:
###..###.#
##......#.
#..#...#.#
#.#.......
##.#.....#
#.#.#.....
...#.....#
..........
#.........
#.##..###.

Tile 3037:
......##..
..#..#....
#.#.......
#.#....#..
.#.#.##..#
#.....#.##
#.....#.#.
.#..##...#
#....##...
...#..###.

Tile 2239:
.####..#..
#.........
.#.......#
#..##.....
##..##..##
#.#....#..
.........#
#.......#.
....#.....
#.###..#.#

Tile 3313:
##.##.#..#
.#.#..#...
.##...##.#
.#.##..#..
##........
..........
#..#.#....
#.........
..........
.##..#..#.

Tile 3361:
.###.#...#
##..#.#..#
...##....#
#..##.....
..........
#......#.#
.........#
..#..##.#.
#..#...###
#...#.#.#.

Tile 3167:
..##..####
#.....#.#.
.....#.#..
...#......
....#.#.##
...#.#.#..
.......#..
##........
#..#...#.#
####.##..#

Tile 1979:
#.#.###...
..#.....##
...#...##.
#.......##
........##
..##..#...
..#......#
#.#....#.#
#..#.....#
.##.......

Tile 1831:
##.##.##.#
#.........
.........#
##.......#
###.....##
..##..##..
##.....#.#
#....#...#
###.##..#.
#..#####..

Tile 1487:
#..#....##
.#..#....#
#....#....
#.........
#.#...#.##
#..##...##
...##..#..
.#...##...
.#........
.#...#..#.

Tile 1987:
###..#....
##..##...#
......#..#
.#.#...#.#
.....#.#..
....#..#..
....###..#
#...##....
###.....#.
...##.####

Tile 3083:
....##..#.
##..#.###.
#..#...##.
#.###.....
.........#
....#.....
.#........
.#........
#.........
#.#.#.##.#

Tile 1543:
...##..###
.........#
.......#.#
#..#..#.##
##....#.#.
....#..#..
#..#......
...#...#.#
##.##..#..
#.###..#..

Tile 1151:
#.#..#####
#.#..#...#
#..#......
....#...#.
..........
#...#.#..#
#..#.#...#
##....#..#
#.........
##.....###

Tile 1009:
##..#...##
#....#...#
.#...#....
#........#
.#..#..#..
.###.##.#.
#......#.#
##.#..##..
#....#.###
####...##.

Tile 3929:
......#.#.
#..#.##.##
....#.#.##
#.##..#...
###..#..#.
.##..###.#
.##......#
....#....#
........#.
.#...###..

Tile 1321:
#.##..#...
.##.....##
#.#..#....
...#.....#
###......#
#.#.#.##.#
##.......#
##......#.
.#...#....
.#..##..##

Tile 2017:
###.#..###
.#..###..#
#..#......
.........#
..#...##..
....#.##.#
...##.#..#
....#...##
#..#..##..
##.#.#.#..

Tile 1747:
....##.#..
#........#
.....#..#.
..#####...
######..#.
##..#.#...
.###..#..#
#.....#...
.##..#..##
..#####...

Tile 3089:
#....#.##.
#.....#..#
..........
#..#.#....
.......#..
#.....#...
........#.
##..#..##.
#.....#..#
#.#.#....#

Tile 3019:
.#..###.##
.#...#...#
#.#.......
###.......
#....#...#
#.##...#..
##........
.#.......#
.#.#......
.#..#...#.

Tile 3079:
...#.###..
#......#..
#.......##
#...#..###
#.......#.
......#.#.
#........#
.#.#...###
..#.#....#
...#...#.#

Tile 1663:
##.##..###
#.....##.#
......#.##
#........#
..#.#.....
....#..#.#
#.#.#..#.#
#.......#.
..#......#
#.#..#....

Tile 1823:
.###...###
#.#.#..##.
..........
.........#
###....#..
..........
##....#.##
#.......##
..#..#...#
......####

Tile 3823:
....#..#..
..#.#..#.#
###.#.##.#
..##....#.
#.........
#....#...#
#.......##
#.#...##..
..#....#..
..#....##.

Tile 1901:
#.#.#....#
..#....#.#
...#..#.#.
.#..#..###
....####..
......#...
#....#....
..#....#..
#......#..
######.#..

Tile 3347:
#.#.....#.
#..#..#...
#.#.......
#..#.#....
...#......
#.........
##.#.....#
#........#
#....#...#
#.#.##.###

Tile 1873:
..###.#.##
.#.#....#.
#........#
..#..#...#
##.....#..
#........#
#.........
.#........
#.#..#.#.#
.##.#...##

Tile 2053:
#.#.#.#..#
#...###..#
##.##.##.#
....##.#.#
#.###....#
#.....#..#
#..##.####
....#..#..
#.........
#..#.#..#.

Tile 2659:
.#....##.#
#.#......#
#..#......
.#.###.#.#
..........
#........#
.......#.#
....#....#
#........#
##..##.#..

Tile 2503:
.#..####.#
#.##......
..#....###
..#..#.###
...##...##
..#.....#.
..........
##.#......
#.#.......
#...#..#.#

Tile 3881:
##.###.###
#......#..
#...#....#
..#.#....#
#..#..#..#
#..#.....#
...#..##.#
#.#.......
#..##....#
...#.##...

Tile 1973:
..#.###.#.
#.##....##
#.......##
##......##
#.........
#.#..#....
.#....###.
..#.#..#..
......#..#
#..#.....#

Tile 3329:
.#.#.###.#
..#.#.....
.#.......#
#..#.##.##
#.##..####
..#.##..##
....#.....
#...#.#.#.
...#.#...#
.#...##..#

Tile 3331:
#......###
#......#.#
#.#.#.#..#
........#.
.##.####..
#..#..#..#
.#.......#
......#.##
......#.#.
.##...#.#.

Tile 1307:
##.#.#..#.
.........#
.#....##.#
#.........
#.........
#....#.#..
........##
......##..
..#.##...#
..##...##.

Tile 2543:
.#.#.##.##
#........#
..##......
#.........
##...#...#
.###..##.#
.##......#
.#........
.....#.#..
...######.

Tile 2003:
#.#..#.#.#
.....#....
#.#.#.....
####.#..##
..###....#
....#.#...
#.####...#
.##...#.##
#.#.#..#..
...#.....#

Tile 3301:
##....##.#
.....#...#
#........#
..........
###.##.#..
.....#...#
#.#......#
....##...#
#........#
.#.#...#.#

Tile 2297:
#..#.##..#
...#.#.##.
..###..#..
##..#.....
####..#..#
..#.#..#..
.....#...#
#...#.....
#.....#..#
##....#...

Tile 2311:
##.....#.#
##........
#........#
#...##....
#......#..
.........#
.........#
#..#.#....
.....#...#
###.#..##.

Tile 1361:
.#.##.#..#
#.#..#...#
#....###..
..###.#...
#..#.....#
#..#...##.
#.#.....#.
.......#.#
##.##.....
#.###.#..#

Tile 1481:
.####.#.##
..........
.........#
###.#.#...
##....##.#
..#...#.##
..##.#.#..
#.#.....##
.......#..
....###...

Tile 1153:
.##.##..##
###......#
#....##...
......#.#.
#....#....
.....##..#
.....#...#
#.........
#...#....#
##..#.#...

Tile 2153:
#.###.#..#
..#.##....
..##....#.
##...#...#
#...#.....
........#.
#..##...#.
..#.......
#...##.#..
#.#.#.#...

Tile 2377:
.##..##.#.
...##..#.#
#.#.#.....
#.##......
#.....#..#
#...#....#
...##....#
...###....
.#.##...##
.###.##...

Tile 3863:
.##.###.##
.......#.#
#........#
##.#.#...#
##...#...#
#...##....
#..#..#.##
.....#####
##.#..###.
....###...

Tile 1163:
##..######
#........#
.#.#...###
..#..#...#
##..#...##
#.#.......
#.#..#....
#..#.#....
###..#...#
.#####.###

Tile 2207:
.#..#.#.##
##.....#.#
#..#.....#
#..#....##
.........#
...#.....#
#...#..#..
..#.....##
.....#....
#.##.....#

Tile 1201:
#.##.##..#
#.#.......
#..#.....#
.###...#..
#.#......#
........##
.........#
.##....#.#
..##.#...#
.......###

Tile 1619:
#.....#.#.
...#.##..#
#.....#...
#...#.....
#..#...#.#
#..##.#...
.#...#.#..
#......##.
#.........
#.##...###

Tile 3389:
...#..##..
#........#
#...#.....
#.#....#.#
###....#.#
#.#....###
#..##..#.#
.##.#.#..#
#...###...
#...#....#

Tile 3359:
.###..##..
#........#
###...#.#.
........##
....#..#.#
.#.#......
#........#
.......#.#
.#.....#..
##.###....
""".strip().split(
    "\n\n"
)

inp = [parse_tile(x) for x in inp_o]
